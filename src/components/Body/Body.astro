---
import { db, Teams, Games } from 'astro:db'
import { getNhlTeams } from '../../utils/hockeyData.ts'
import { getNFLTeams } from '../../utils/usFootballData'
import DateSelector from './DateSelector/DateSelector.astro'
import GamesSelected from './GamesSelected/GamesSelected.tsx'
import Team from './Team/Team'

let activeTeams = await db.select().from(Teams)
activeTeams = await getNhlTeams()
await getNFLTeams()
const teamsGames = await db.select().from(Games)

let teamsSelectedIds: string[] = ['WPG', 'EDM', 'CGY', 'VAN', 'SEA']

while (teamsSelectedIds.length < 5) {
  const randomTeam = activeTeams[Math.floor(Math.random() * activeTeams.length)].id
  if (!teamsSelectedIds.includes(randomTeam)) {
    teamsSelectedIds.push(randomTeam)
  }
}
---

<GamesSelected client:visible />
<DateSelector />
<Team {activeTeams} {teamsSelectedIds} {teamsGames} client:visible />
